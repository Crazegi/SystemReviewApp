<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SystemReview.Views.DiagnosticsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <ScrollViewer Padding="16">
        <StackPanel Spacing="16">
            <Grid ColumnSpacing="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button x:Name="RefreshBtn" Content="ðŸ”„ Refresh" Click="RefreshBtn_Click" Grid.Column="0" Style="{StaticResource AccentButtonStyle}"/>
                <Button x:Name="MonitorBtn" Content="â±ï¸ Start Monitor" Click="MonitorBtn_Click" Grid.Column="1"/>
                <Button x:Name="DiagBtn" Content="ðŸ©º Run Diagnostics" Click="DiagBtn_Click" Grid.Column="2"/>
                <Button Content="ðŸ“‹ Export JSON" Click="ExportJsonBtn_Click" Grid.Column="3"/>
                <Button Content="ðŸ“ Export Text" Click="ExportTextBtn_Click" Grid.Column="4"/>
                <TextBlock x:Name="StatusText" Grid.Column="5" VerticalAlignment="Center" Margin="12,0,0,0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
            </Grid>
            <ProgressBar x:Name="LoadingBar" IsIndeterminate="True" Visibility="Collapsed"/>

            <TextBlock Text="ðŸ“ˆ Performance Counters" Style="{StaticResource SubtitleTextBlockStyle}"/>
            <ListView x:Name="PerfList" SelectionMode="None" MaxHeight="200">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" Spacing="8" Padding="4">
                            <TextBlock Text="{Binding Key}" FontWeight="SemiBold" Width="200"/>
                            <TextBlock Text="{Binding Value}"/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <TextBlock Text="ðŸ“‹ Recent Event Logs (Errors/Warnings)" Style="{StaticResource SubtitleTextBlockStyle}"/>
            <ListView x:Name="EventLogList" SelectionMode="None" MaxHeight="350">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Padding="8" Spacing="4">
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <TextBlock Text="{Binding Level}" FontWeight="Bold" Foreground="OrangeRed"/>
                                <TextBlock Text="{Binding Source}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding TimeGenerated}" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                            </StackPanel>
                            <TextBlock Text="{Binding Message}" TextWrapping="Wrap" Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}" FontSize="12"/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <TextBlock Text="âš™ï¸ Network Services" Style="{StaticResource SubtitleTextBlockStyle}"/>
            <ListView x:Name="ServiceList" SelectionMode="None" MaxHeight="350">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="4" ColumnSpacing="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="180"/><ColumnDefinition Width="*"/><ColumnDefinition Width="80"/><ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="{Binding Name}" Grid.Column="0" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding DisplayName}" Grid.Column="1" TextTrimming="CharacterEllipsis"/>
                            <TextBlock Text="{Binding Status}" Grid.Column="2"/>
                            <TextBlock Text="{Binding StartType}" Grid.Column="3"/>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <TextBlock Text="ðŸ©º Diagnostic Log" Style="{StaticResource SubtitleTextBlockStyle}"/>
            <ListView x:Name="DiagLogList" SelectionMode="None" MaxHeight="400">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" FontFamily="Consolas" FontSize="12" Padding="2" TextWrapping="Wrap"/>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackPanel>
    </ScrollViewer>
</Page>
<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="SystemReview.Views.SystemSpecsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid>
        <!-- Top Command Bar -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Padding="20,16,20,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button x:Name="RefreshBtn" Click="RefreshBtn_Click" Grid.Column="0" Style="{StaticResource AccentButtonStyle}" Padding="16,8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE72C;" FontSize="14"/>
                    <TextBlock Text="Refresh All"/>
                </StackPanel>
            </Button>
            <Button x:Name="ExportJsonBtn" Click="ExportJsonBtn_Click" Grid.Column="1" Margin="8,0,0,0" Padding="16,8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE8B7;" FontSize="14"/>
                    <TextBlock Text="Export JSON"/>
                </StackPanel>
            </Button>
            <Button x:Name="ExportTextBtn" Click="ExportTextBtn_Click" Grid.Column="2" Margin="8,0,0,0" Padding="16,8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE8A5;" FontSize="14"/>
                    <TextBlock Text="Export Text"/>
                </StackPanel>
            </Button>
            <TextBlock x:Name="StatusText" Grid.Column="3" VerticalAlignment="Center" HorizontalAlignment="Right"
                       Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" FontSize="12"/>
        </Grid>

        <ProgressBar x:Name="LoadingBar" Grid.Row="1" IsIndeterminate="True" Visibility="Collapsed" Margin="20,0"/>

        <!-- Scrollable Content -->
        <ScrollViewer Grid.Row="2" Padding="20,8,20,20">
            <StackPanel Spacing="16">

                <!-- ══════════ CPU CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE950;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Processor (CPU)" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <ListView x:Name="CpuList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="8,12" ColumnSpacing="4" RowSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Name" Grid.Row="0" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Name}" Grid.Row="0" Grid.Column="1" FontWeight="SemiBold" TextWrapping="Wrap"/>

                                        <TextBlock Text="Cores" Grid.Row="1" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Cores}" Grid.Row="1" Grid.Column="1"/>

                                        <TextBlock Text="Logical Procs" Grid.Row="2" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding LogicalProcessors}" Grid.Row="2" Grid.Column="1"/>

                                        <TextBlock Text="Max Speed" Grid.Row="3" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding MaxSpeed}" Grid.Row="3" Grid.Column="1"/>

                                        <TextBlock Text="Architecture" Grid.Row="4" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Architecture}" Grid.Row="4" Grid.Column="1"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ RAM CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xEC4E;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Memory (RAM)" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <!-- RAM bar visual -->
                        <Grid x:Name="RamBarGrid" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <ProgressBar x:Name="RamUsageBar" Grid.Row="0" Maximum="100" Height="24" CornerRadius="4"/>
                            <TextBlock x:Name="RamUsageText" Grid.Row="1" HorizontalAlignment="Center" Margin="0,4,0,0"
                                       Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" FontSize="12"/>
                        </Grid>

                        <Grid ColumnSpacing="16" RowSpacing="8" x:Name="RamGrid">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                        </Grid>

                        <ListView x:Name="RamList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="4,6" ColumnSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Key}" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Value}" Grid.Column="1" FontWeight="SemiBold"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ GPU CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE7F8;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Graphics (GPU)" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <ListView x:Name="GpuList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="8,12" ColumnSpacing="4" RowSpacing="8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Text="Name" Grid.Row="0" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Name}" Grid.Row="0" Grid.Column="1" FontWeight="SemiBold" TextWrapping="Wrap"/>

                                        <TextBlock Text="Driver" Grid.Row="1" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding DriverVersion}" Grid.Row="1" Grid.Column="1"/>

                                        <TextBlock Text="VRAM" Grid.Row="2" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding AdapterRam}" Grid.Row="2" Grid.Column="1"/>

                                        <TextBlock Text="Processor" Grid.Row="3" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding VideoProcessor}" Grid.Row="3" Grid.Column="1"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ STORAGE CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xEDA2;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Storage Drives" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <ListView x:Name="DriveList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                                            CornerRadius="6" Padding="16,12" Margin="0,4">
                                        <Grid RowSpacing="8">
                                            <Grid.RowDefinitions>
                                                <RowDefinition/><RowDefinition/><RowDefinition/><RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="120"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Drive header row -->
                                            <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Spacing="8">
                                                <FontIcon Glyph="&#xE7F8;" FontSize="14"/>
                                                <TextBlock FontWeight="Bold" FontSize="15">
                                                    <Run Text="{Binding Name}"/>
                                                    <Run Text=" "/>
                                                    <Run Text="{Binding Label}"/>
                                                </TextBlock>
                                                <Border Background="{ThemeResource AccentFillColorDefaultBrush}" CornerRadius="4" Padding="8,2">
                                                    <TextBlock Text="{Binding DriveType}" FontSize="11" Foreground="White"/>
                                                </Border>
                                                <TextBlock Text="{Binding FileSystem}" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" VerticalAlignment="Center"/>
                                            </StackPanel>

                                            <!-- Usage bar -->
                                            <TextBlock Text="Used" Grid.Row="1" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" VerticalAlignment="Center"/>
                                            <Grid Grid.Row="1" Grid.Column="1">
                                                <ProgressBar Value="{Binding UsedPercent}" Maximum="100" Height="18" CornerRadius="4"/>
                                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="11">
                                                    <Run Text="{Binding UsedPercent}"/><Run Text="%"/>
                                                </TextBlock>
                                            </Grid>

                                            <TextBlock Text="Total" Grid.Row="2" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                            <TextBlock Text="{Binding TotalSize}" Grid.Row="2" Grid.Column="1" FontWeight="SemiBold"/>

                                            <TextBlock Text="Free" Grid.Row="3" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                            <TextBlock Text="{Binding FreeSpace}" Grid.Row="3" Grid.Column="1" FontWeight="SemiBold"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ OS CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE770;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Operating System" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <ListView x:Name="OsList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="4,6" ColumnSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Key}" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Value}" Grid.Column="1" FontWeight="SemiBold" TextWrapping="Wrap"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ MOTHERBOARD / BIOS CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE964;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Motherboard / BIOS" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <ListView x:Name="MbList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="4,6" ColumnSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Key}" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Value}" Grid.Column="1" FontWeight="SemiBold" TextWrapping="Wrap"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ DISPLAY CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE7F4;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Display" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>

                        <ListView x:Name="DisplayList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="4,6" ColumnSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Key}" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Value}" Grid.Column="1" FontWeight="SemiBold" TextWrapping="Wrap"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ BATTERY CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE83F;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Battery" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>
                        <ListView x:Name="BatteryList" SelectionMode="None" Padding="0">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="4,6" ColumnSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="120"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Key}" Grid.Column="0" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                                        <TextBlock Text="{Binding Value}" Grid.Column="1" FontWeight="SemiBold"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- ══════════ INSTALLED SOFTWARE CARD ══════════ -->
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1"
                        CornerRadius="8" Padding="20">
                    <StackPanel Spacing="12">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <FontIcon Glyph="&#xE71D;" FontSize="22" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                            <TextBlock Text="Installed Programs (Top 20)" Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>
                        <ListView x:Name="SoftwareList" SelectionMode="None" Padding="0" MaxHeight="400">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="4,6" ColumnSpacing="16">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="100"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="{Binding Key}" Grid.Column="0" TextTrimming="CharacterEllipsis"/>
                                        <TextBlock Text="{Binding Value}" Grid.Column="1" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" FontSize="12"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </StackPanel>
                </Border>

                <!-- Bottom spacer -->
                <Border Height="20"/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>